from  numpy import *

def rot(ph,th,ps,sy):
    ao=mat([ph,th,ps])
    rot=mat(symdic[sy])
    return (ao*rot)


def norm180(num):
    if num > 180:
        num -= 360.0
    elif num < -180:
        num += 360.0
    elif -180<=num<=180:
        num = num
    return num

#bin lie
def binlie():
    for j in range(4):
        op=open("sym%s"%(j),'w')
        f=open('nohead','r')
        for i in f.readlines():
            k=i.split(' ')
            out=rot(float(k[1]),float(k[2]),float(k[3]),j).tolist()[0]
    	    print(out)
	    #print("%s %s %s"%(out[0],out[1],out[2]))
	    op.write("%s %s %s %s %s"%(k[0],norm180(out[0]),norm180(out[1]),norm180(out[2]),' '.join(str(g) for g in k[4:])))
        f.close()

#yi ge ke li 60 ci
def allin():
    f=open('nohead','r')
    allsym=open('allsym','w')
    for i in f.readlines():
        k=i.split(' ')
        for j in range(60):
	    out=rot(float(k[1]),float(k[2]),float(k[3]),j).tolist()[0]
	    allsym.write("%s %s %s %s %s"%(k[0],norm180(out[0]),norm180(out[1]),norm180(out[2]),' '.join(str(g) for g in k[4:])))

#eman 60
# psi test  range6

def emansym():
    f=open('nohead','r')
    allsym=open('allsym','w')
    for i in f.readlines():
        k=i.split(' ')
        for j in range(5):
	    allsym.write("%s %s %s %s %s"%(k[0],norm180(float(k[1])+symdic2[j][0]),norm180(float(k[2])+symdic2[j][1]),norm180(float(k[3])+symdic2[j][2]),' '.join(str(g) for g in k[4:])))


symdic=[[
[1,0,0],
[0,1,0],
[0,0,1]
],[
[-0.44721,0,0.89443],
[0,-1,0],
[0.89443,0,0.44721]
],[
[0.8618,0.42533,0.27639],
[-0.42533,0.30902,0.85065],
[0.27639,-0.85065,0.44721]
],[
[0.6382,0.26287,0.72361],
[-0.26287,-0.80902,0.52573],
[0.72361,-0.52573,-0.44721]
],[
[0.6382,-0.26287,0.72361],
[0.26287,-0.80902,-0.52573],
[0.72361,0.52573,-0.44721]
],[
[0.8618,-0.42533,0.27639],
[0.42533,0.30902,-0.85065],
[0.27639,0.85065,0.44721]
],[
[-0.1382,0.95106,0.27639],
[-0.42533,-0.30902,0.85065],
[0.89443,0,0.44721]
],[
[-0.1382,-0.42533,0.89443],
[0.95106,-0.30902,0],
[0.27639,0.85065,0.44721]
],[
[-0.1382,-0.95106,0.27639],
[0.42533,-0.30902,-0.85065],
[0.89443,0,0.44721]
],[
[0.3618,-0.58779,-0.72361],
[0.26287,0.80902,-0.52573],
[0.89443,0,0.44721]
],[
[0.3618,-0.26287,0.89443],
[0.58779,0.80902,0],
[-0.72361,0.52573,0.44721]
],[
[0.3618,0.58779,-0.72361],
[-0.26287,0.80902,0.52573],
[0.89443,0,0.44721]
],[
[0.3618,0.26287,0.89443],
[-0.58779,0.80902,0],
[-0.72361,-0.52573,0.44721]
],[
[-0.1382,0.42533,0.89443],
[-0.95106,-0.30902,0],
[0.27639,-0.85065,0.44721]
],[
[-0.052786,0.68819,0.72361],
[0.68819,-0.5,0.52573],
[0.72361,0.52573,-0.44721]
],[
[0.44721,0.52573,0.72361],
[0.85065,0,-0.52573],
[-0.27639,0.85065,-0.44721]
],[
[0.67082,0.68819,0.27639],
[-0.16246,0.5,-0.85065],
[-0.72361,0.52573,0.44721]
],[
[0.309017,0.95105654,0],
[-0.95105654,0.30901697,0],
[0,0,1]
],[
[0.309017,-0.95105654,0],
[0.95105654,0.309017,0],
[0,0,1]
],[
[0.44721,0.85065,-0.27639],
[0.52573,0,0.85065],
[0.72361,-0.52573,-0.44721]
],[
[0.67082,-0.16246,-0.72361],
[0.68819,0.5,0.52573],
[0.27639,-0.85065,0.44721]
],[
[0.67082,-0.68819,0.27639],
[0.16246,0.5,0.85065],
[-0.72361,-0.52573,0.44721]
],[
[0.44721,-0.52573,0.72361],
[-0.85065,0,0.52573],
[-0.27639,-0.85065,-0.44721]
],[
[-0.052786,-0.68819,0.72361],
[-0.68819,-0.5,-0.52573],
[0.72361,-0.52573,-0.44721]
],[
[-0.809017,0.58778524,0],
[-0.58778524,-0.809017,0],
[0,0,1]
],[
[0.67082,0.16246,-0.72361],
[-0.68819,0.5,-0.52573],
[0.27639,0.85065,0.44721]
],[
[0.94721,-0.16246,-0.27639],
[0.16246,-0.5,0.85065],
[-0.27639,-0.85065,-0.44721]
],[
[0.80902,-0.58779,0],
[-0.58779,-0.80902,0],
[0,0,-1]
],[
[0.44721,-0.85065,-0.27639],
[-0.52573,0,-0.85065],
[0.72361,0.52573,-0.44721]
],[
[-0.67082,-0.68819,-0.27639],
[-0.16246,0.5,-0.85065],
[0.72361,-0.52573,-0.44721]
],[
[-0.94721,-0.16246,0.27639],
[-0.16246,-0.5,-0.85065],
[0.27639,-0.85065,0.44721]
],[
[-0.809017,-0.58778524,0],
[0.58778524,-0.809017,0],
[0,0,1]
],[
[-0.44721,0.52573,-0.72361],
[-0.85065,0,0.52573],
[0.27639,0.85065,0.44721]
],[
[-0.94721,0.16246,0.27639],
[0.16246,-0.5,0.85065],
[0.27639,0.85065,0.44721]
],[
[-0.67082,0.16246,0.72361],
[0.68819,0.5,0.52573],
[-0.27639,0.85065,-0.44721]
],[
[0.80902,0.58779,0],
[0.58779,-0.80902,0],
[0,0,-1]
],[
[0.94721,0.16246,-0.27639],
[-0.16246,-0.5,-0.85065],
[-0.27639,0.85065,-0.44721]
],[
[-0.3618,-0.26287,-0.89443],
[-0.58779,0.80902,0],
[0.72361,0.52573,-0.44721]
],[
[-0.67082,0.68819,-0.27639],
[0.16246,0.5,0.85065],
[0.72361,0.52573,-0.44721]
],[
[-0.3618,0.26287,-0.89443],
[0.58779,0.80902,0],
[0.72361,-0.52573,-0.44721]
],[
[-0.44721,-0.52573,-0.72361],
[0.85065,0,-0.52573],
[0.27639,-0.85065,0.44721]
],[
[-0.44721,-0.85065,0.27639],
[0.52573,0,0.85065],
[-0.72361,0.52573,0.44721]
],[
[-0.3618,-0.58779,0.72361],
[-0.26287,0.80902,0.52573],
[-0.89443,0,-0.44721]
],[
[-0.67082,-0.16246,0.72361],
[-0.68819,0.5,-0.52573],
[-0.27639,-0.85065,-0.44721]
],[
[-0.3618,0.58779,0.72361],
[0.26287,0.80902,-0.52573],
[-0.89443,0,-0.44721]
],[
[-0.44721,0.85065,0.27639],
[-0.52573,0,-0.85065],
[-0.72361,-0.52573,0.44721]
],[
[-0.30902,0.95106,0],
[0.95106,0.30902,0],
[0,0,-1]
],[
[0.1382,0.95106,-0.27639],
[0.42533,-0.30902,-0.85065],
[-0.89443,0,-0.44721]
],[
[0.052786,0.68819,-0.72361],
[-0.68819,-0.5,-0.52573],
[-0.72361,0.52573,0.44721]
],[
[0.1382,0.42533,-0.89443],
[0.95106,-0.30902,0],
[-0.27639,-0.85065,-0.44721]
],[
[0.052786,-0.68819,-0.72361],
[0.68819,-0.5,0.52573],
[-0.72361,-0.52573,0.44721]
],[
[0.1382,-0.95106,-0.27639],
[-0.42533,-0.30902,0.85065],
[-0.89443,0,-0.44721]
],[
[-0.30902,-0.95106,0],
[-0.95106,0.30902,0],
[0,0,-1]
],[
[0.44721,0,-0.89443],
[0,-1,0],
[-0.89443,0,-0.44721]
],[
[0.1382,-0.42533,-0.89443],
[-0.95106,-0.30902,0],
[-0.27639,0.85065,-0.44721]
],[
[-0.6382,-0.26287,-0.72361],
[-0.26287,-0.80902,0.52573],
[-0.72361,0.52573,0.44721]
],[
[-0.8618,-0.42533,-0.27639],
[-0.42533,0.30902,0.85065],
[-0.27639,0.85065,-0.44721]
],[
[-0.8618,0.42533,-0.27639],
[0.42533,0.30902,-0.85065],
[-0.27639,-0.85065,-0.44721]
],[
[-0.6382,0.26287,-0.72361],
[0.26287,-0.80902,-0.52573],
[-0.72361,-0.52573,0.44721]
],[
[-1,0,0],
[0,1,0],
[0,0,-1]
]]

symdic2=[
[0.0,0.0,0.0],
[0.0,0.0,288.000000027],
[0.0,0.0,216.000011642],
[0.0,0.0,144.000000661],
[0.0,0.0,71.9999999727],
[215.999993439,63.4348973743,180.000003],
[144.000020316,63.4348971523,180.000003],
[71.9999929777,63.4348969667,180.000003],
[3.00000012032e-06,63.4348968955,180.000003],
[288.000000395,63.4348977113,180.000003],
[215.999993439,63.4348973743,251.999992978],
[144.000020316,63.4348971523,251.999992978],
[71.9999929777,63.4348969667,251.999992978],
[3.00000012032e-06,63.4348968955,251.999992978],
[288.000000395,63.4348977113,251.999992978],
[215.999993439,63.4348973743,324.000020316],
[144.000020316,63.4348971523,324.000020316],
[71.9999929777,63.4348969667,324.000020316],
[3.00000012032e-06,63.4348968955,324.000020316],
[288.000000395,63.4348977113,324.000020316],
[215.999993439,63.4348973743,35.9999934394],
[144.000020316,63.4348971523,35.9999934394],
[71.9999929777,63.4348969667,35.9999934394],
[3.00000012032e-06,63.4348968955,35.9999934394],
[288.000000395,63.4348977113,35.9999934394],
[215.999993439,63.4348973743,107.999982875],
[144.000020316,63.4348971523,107.999982875],
[71.9999929777,63.4348969667,107.999982875],
[3.00000012032e-06,63.4348968955,107.999982875],
[288.000000395,63.4348977113,107.999982875],
[180.000008,116.565104632,215.999998773],
[107.99999858,116.565104052,215.999998773],
[35.9999987727,116.565104491,215.999998773],
[324.000001227,116.565104491,215.999998773],
[251.999997789,116.56510358,215.999998773],
[180.000008,116.565104632,287.99999858],
[107.99999858,116.565104052,287.99999858],
[35.9999987727,116.565104491,287.99999858],
[324.000001227,116.565104491,287.99999858],
[251.999997789,116.56510358,287.99999858],
[180.000008,116.565104632,7.99999975243e-06],
[107.99999858,116.565104052,7.99999975243e-06],
[35.9999987727,116.565104491,7.99999975243e-06],
[324.000001227,116.565104491,7.99999975243e-06],
[251.999997789,116.56510358,7.99999975243e-06],
[180.000008,116.565104632,71.9999977889],
[107.99999858,116.565104052,71.9999977889],
[35.9999987727,116.565104491,71.9999977889],
[324.000001227,116.565104491,71.9999977889],
[251.999997789,116.56510358,71.9999977889],
[180.000008,116.565104632,143.999992805],
[107.99999858,116.565104052,143.999992805],
[35.9999987727,116.565104491,143.999992805],
[324.000001227,116.565104491,143.999992805],
[251.999997789,116.56510358,143.999992805],
[0.0,180.0,359.999995],
[0.0,180.0,72.0000048446],
[0.0,180.0,144.000005432],
[0.0,180.0,216.000013649],
[0.0,180.0,288.000004331]]


if __name__ == "__main__":
    emansym()
    #allin()


